import{r as p,A as q,j as s,i as G}from"./index-fqGUgWTJ.js";const U=({data:l,searchTerm:m,setSearchTerm:g,selectedMunicipality:w,setSelectedMunicipality:R,selectedBarangay:_,setSelectedBarangay:D,filteredBarangays:$,municipalityOptions:A,itemsPerPage:C,setItemsPerPage:K,currentPage:d,setCurrentPage:j,theme:E,SelectedSize:f,beneficiaryLimit:n,pagination:o,isLoading:c,selectedIds:u,onToggleSelect:I,onSelectAll:B,onDeselectAll:F,LatestAssistances:N})=>{const{assignAyuda:S}=p.useContext(q),[h,P]=p.useState({showStatusModal:!1,statusModalProps:{status:"success",error:null,title:"",message:"",onRetry:null}}),k=p.useCallback(e=>{P(a=>({...a,...e}))},[]),W=()=>{k({showStatusModal:!1})},v=l.length>0&&l.every(e=>u.has(e._id)),H=l.some(e=>u.has(e._id))&&!v,x=N==null?void 0:N._id,i=p.useCallback((e,a=null,t={})=>{k({showStatusModal:!0,statusModalProps:{status:e,error:a,title:t.title||(e==="success"?"Success":"Error"),message:t.message||"",onRetry:t.onRetry||null,isRFIDAssignment:t.isRFIDAssignment||!1}})},[k]),O=async()=>{if(!x){i("error","No active assistance found.",{title:"Missing ID"});return}const e=l.map(a=>a._id);try{if(v)F(x);else{const a=l.filter(t=>!u.has(t._id)).length;if(n&&f+a>n){i("error",null,{title:"Limit Warning",message:"Selecting all will exceed the beneficiary limit."});return}await S(x,e),B(x),i("success",null,{message:"Bulk selection updated successfully."})}}catch(a){i("error",a.message)}},T=async e=>{if(!x){i("error","No active assistance found.");return}if(!u.has(e)&&n&&f>=n){i("error",null,{message:`Limit reached! You can only select up to ${n} beneficiaries.`});return}try{await S(x,[e]),I(e,x)}catch(t){i("error",t.message)}},Y=()=>{const e=(o==null?void 0:o.totalPages)||1,a=d||1,t=2,M=[],b=[];let y;for(let r=1;r<=e;r++)(r===1||r===e||r>=a-t&&r<=a+t)&&M.push(r);return M.forEach(r=>{y&&(r-y===2?b.push(y+1):r-y!==1&&b.push("...")),b.push(r),y=r}),b};return s.jsxs("div",{className:"relative rounded-lg border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800",children:[s.jsx("div",{className:"border-b border-gray-200 p-4 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[s.jsx("div",{className:"min-w-[200px] flex-1",children:s.jsx("input",{type:"text",placeholder:"Search by name, household ID...",value:m,onChange:e=>g(e.target.value),disabled:c,className:"w-full rounded-lg border px-3 py-2 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700"})}),s.jsx("select",{value:w,onChange:e=>R(e.target.value),disabled:c,className:"rounded-lg border px-3 py-2 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700",children:A.map(e=>s.jsx("option",{value:e,children:e},e))}),s.jsx("select",{value:_,onChange:e=>D(e.target.value),disabled:c||w==="All",className:"rounded-lg border px-3 py-2 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700",children:$.map(e=>s.jsx("option",{value:e,children:e},e))})]}),s.jsxs("div",{className:"text-sm font-medium",children:["Selected: ",s.jsx("span",{className:"text-orange-600",children:f}),n&&s.jsxs("span",{children:[" / ",n]})]})]})}),s.jsxs("div",{className:"relative",children:[c&&s.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-white/50 dark:bg-gray-900/50",children:s.jsxs("div",{className:"flex items-center gap-3 rounded-lg bg-white p-4 shadow-lg dark:bg-gray-800",children:[s.jsx("div",{className:"h-6 w-6 animate-spin rounded-full border-4 border-solid border-orange-600 border-r-transparent"}),s.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:"Processing..."})]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm text-gray-500 dark:text-gray-400",children:[s.jsx("thead",{className:"bg-gray-50 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400",children:s.jsxs("tr",{children:[s.jsx("th",{className:"w-10 px-6 py-3",children:s.jsx("input",{type:"checkbox",checked:v,ref:e=>e&&(e.indeterminate=H),onChange:O,disabled:c,className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700"})}),s.jsx("th",{className:"px-6 py-3",children:"Name"}),s.jsx("th",{className:"px-6 py-3",children:"Household ID"}),s.jsx("th",{className:"px-6 py-3",children:"Barangay"}),s.jsx("th",{className:"px-6 py-3",children:"Status"})]})}),s.jsx("tbody",{children:l.map(e=>s.jsxs("tr",{className:"border-b hover:bg-gray-50 dark:border-gray-700 dark:hover:bg-gray-600",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("input",{type:"checkbox",checked:u.has(e._id),onChange:()=>T(e._id),disabled:c,className:"rounded border-gray-300 text-orange-600 focus:ring-orange-500 disabled:opacity-50 dark:border-gray-600 dark:bg-gray-700"})}),s.jsx("td",{className:"px-6 py-4 font-medium text-gray-900 dark:text-white",children:`${e.lastname}, ${e.firstname} ${e.middlename||""}`}),s.jsx("td",{className:"px-6 py-4",children:e.household_id}),s.jsx("td",{className:"px-6 py-4",children:e.barangay}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${J(e.status,E)}`,children:e.status})})]},e._id))})]})})]}),o&&o.totalPages>1&&s.jsx("div",{className:"border-t border-gray-200 p-4 dark:border-gray-700",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[s.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-400",children:["Showing ",(d-1)*C+1," to ",Math.min(d*C,o.totalResidents)," of ",o.totalResidents]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>j(d-1),disabled:d<=1||c,className:"rounded border px-3 py-1 disabled:opacity-50 dark:border-gray-600",children:"Previous"}),Y().map((e,a)=>s.jsx("button",{onClick:()=>typeof e=="number"&&j(e),className:`rounded border px-3 py-1 ${e===d?"bg-orange-600 text-white":"hover:bg-gray-100"}`,children:e},a)),s.jsx("button",{onClick:()=>j(d+1),disabled:d>=o.totalPages||c,className:"rounded border px-3 py-1 disabled:opacity-50 dark:border-gray-600",children:"Next"})]})]})}),s.jsx(G,{isOpen:h.showStatusModal,onClose:W,status:h.statusModalProps.status,error:h.statusModalProps.error,title:h.statusModalProps.title,message:h.statusModalProps.message,onRetry:h.statusModalProps.onRetry})]})},J=(l,m)=>{const g=m==="dark";switch(l){case"Active":return g?"bg-green-900/30 text-green-400":"bg-green-100 text-green-700";case"Inactive":return g?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-700";case"Deceased":return g?"bg-red-900/30 text-red-400":"bg-red-100 text-red-700";default:return g?"bg-gray-800 text-gray-400":"bg-gray-100 text-gray-700"}};export{U as default};
